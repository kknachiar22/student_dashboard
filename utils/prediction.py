# -*- coding: utf-8 -*-
"""Untitled0.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/16va5-_f6j2Aq5Xp4faLhrSYSU6evTtPj
"""

# utils/prediction.py

import joblib
import pandas as pd

def predict_performance(encoded_df):
    """
    Loads the trained model and expected feature list,
    aligns encoded_df to expected columns, then predicts.
    Returns a DataFrame with Predicted Academic & Attendance.
    """
    # Load model & expected features
    model = joblib.load("models/rf_model.pkl")
    expected = joblib.load("models/expected_features.pkl")

    # Reindex, filling missing with 0
    X = encoded_df.reindex(columns=expected, fill_value=0)

    # Predict
    preds = model.predict(X)
    return pd.DataFrame(preds, columns=["Predicted Academic", "Predicted Attendance"])